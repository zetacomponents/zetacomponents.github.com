<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html 
	xmlns="http://www.w3.org/1999/xhtml"
	xml:lang="en"
	lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

	<meta name="description" content="Apache Zeta Components - reusable set of high quality PHP components to fasten your development." />
	<meta name="keywords" content="PHP, apache, components, framework, quality" />
	<meta name="author" content="dotxp" />
	<meta name="language" content="en" />
	<meta name="date" content="Wed, 04 Aug 2010 13:07:08 +0200" />
	<meta name="robots" content="all" />

	<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
	<meta name="DC.title" content="Tutorial" />
	<meta name="DC.creator" content="dotxp" />
	<meta name="DC.date" content="Wed, 04 Aug 2010 13:07:08 +0200" />
	<meta name="DC.rights" content="Copyright" />

	<link rel="meta" href="/zetacomponents/documentation/trunk/UserInput/tutorial.rdf" />
	<link rel="icon" href="/zetacomponents/images/favicon.png" type="image/png" />

	<link rel="Stylesheet" type="text/css" href="/zetacomponents/styles/screen.css" media="screen" />
	<link rel="Stylesheet" type="text/css" href="/zetacomponents/styles/print.css" media="print" />


	<title>Apache Zeta Components - high quality PHP components</title>
</head>
<body>
<div id="wcv">
	<h1>
		<a id="header-png" href="/zetacomponents" title="Apache Zeta Components - high quality PHP components">
			Apache Zeta Components - high quality PHP components
		</a>
	</h1>

	<ul class="navigation">
<li >
	<a href="/zetacomponents/news.html" title="About">About</a>
	</li>
<li >
	<a href="/zetacomponents/community/index.html" title="Community">Community</a>
	</li>
<li class="requested">
	<a href="/zetacomponents/documentation/overview.html" title="Documentation">Documentation</a>
	</li>
<li >
	<a href="/zetacomponents/download/index.html" title="Download">Download</a>
	</li>
<li >
	<a href="/zetacomponents/support.html" title="Support">Support</a>
	</li>

</ul>
<ul class="subnavigation">
<li >
	<a href="/zetacomponents/documentation/overview.html" title="Overview">Overview</a>
	</li>
<li >
	<a href="/zetacomponents/documentation/install.html" title="Installation">Installation</a>
	</li>

</ul>

	<div class="content">
    <ul class="tabs">
    <li class="requested">
	<a href="/zetacomponents/documentation/trunk/UserInput/tutorial.html" title="Tutorial">Tutorial</a>
	</li>
<li >
	<a href="/zetacomponents/documentation/trunk/UserInput/phpdoc/classtrees.html" title="API">API</a>
	</li>

</ul>

		<h2>eZ Components - UserInput</h2><div class="toc"><h3>Table of Contents</h3><ul><li><p><a href="#introduction">Introduction</a></p></li><li><p><a href="#class-overview">Class overview</a></p></li><li><p><a href="#basic-usage">Basic usage</a></p></li><li><p><a href="#more-information">More information</a></p></li></ul></div><a name="introduction"></a><a name="id1"></a><h3>Introduction</h3><p>The UserInput component facilitates the secure handling of input data. With a user-defined form definition, the component analyzes, filters and returns GET and POST data. The component will not render forms to HTML from its definition, but only handle incoming data. Filtering is done through PHP's <a href="http://pecl.php.net/filter">filter</a> extension; accordingly, UserInput supports all filters and flags that this extension supports.</p><a name="class-overview"></a><a name="id2"></a><h3>Class overview</h3><dl><dt>ezcInputForm</dt><dd>This class validates the definition, processes the form data and provides functionality for accessing the submitted data.</dd><dt>ezcInputFormDefinitionElement</dt><dd>This container class wraps around the definition for each form element. It contains information about whether the field is optional or required, the filter name and optional flags for the filter.</dd></dl><a name="basic-usage"></a><a name="id3"></a><h3>Basic usage</h3><p>The example in this section is separated into multiple parts to allow for easier explanation.</p><ol class="code">
<li><span style="color: #000000">&lt;?php</span></li>
<li><span style="color: #000000">$definition&nbsp;</span><span style="color: #0000FF">=&nbsp;array(</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'firstName'&nbsp;</span><span style="color: #0000FF">=&gt;&nbsp;new&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/UserInput/phpdoc/ezcInputFormDefinitionElement.html'>ezcInputFormDefinitionElement</a></span><span style="color: #0000FF">(</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/UserInput/phpdoc/ezcInputFormDefinitionElement.html#constREQUIRED'>ezcInputFormDefinitionElement::REQUIRED</a></span><span style="color: #0000FF">,&nbsp;</span><span style="color: #335533">'string'</span></li>
<li><span style="color: #335533">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF">),</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'lastName'&nbsp;</span><span style="color: #0000FF">=&gt;&nbsp;new&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/UserInput/phpdoc/ezcInputFormDefinitionElement.html'>ezcInputFormDefinitionElement</a></span><span style="color: #0000FF">(</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/UserInput/phpdoc/ezcInputFormDefinitionElement.html#constREQUIRED'>ezcInputFormDefinitionElement::REQUIRED</a></span><span style="color: #0000FF">,&nbsp;</span><span style="color: #335533">'string'</span></li>
<li><span style="color: #335533">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF">),</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'age'&nbsp;</span><span style="color: #0000FF">=&gt;&nbsp;new&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/UserInput/phpdoc/ezcInputFormDefinitionElement.html'>ezcInputFormDefinitionElement</a></span><span style="color: #0000FF">(</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/UserInput/phpdoc/ezcInputFormDefinitionElement.html#constREQUIRED'>ezcInputFormDefinitionElement::REQUIRED</a></span><span style="color: #0000FF">,&nbsp;</span><span style="color: #335533">'int'</span><span style="color: #0000FF">,</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array(&nbsp;</span><span style="color: #335533">'min_range'&nbsp;</span><span style="color: #0000FF">=&gt;&nbsp;</span><span style="color: #000000">1</span><span style="color: #0000FF">,&nbsp;</span><span style="color: #335533">'max_range'&nbsp;</span><span style="color: #0000FF">=&gt;&nbsp;</span><span style="color: #000000">99&nbsp;</span><span style="color: #0000FF">),</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">FILTER_FLAG_ALLOW_HEX</span></li>
<li><span style="color: #000000">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF">),</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'email'&nbsp;</span><span style="color: #0000FF">=&gt;&nbsp;new&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/UserInput/phpdoc/ezcInputFormDefinitionElement.html'>ezcInputFormDefinitionElement</a></span><span style="color: #0000FF">(</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/UserInput/phpdoc/ezcInputFormDefinitionElement.html#constREQUIRED'>ezcInputFormDefinitionElement::REQUIRED</a></span><span style="color: #0000FF">,&nbsp;</span><span style="color: #335533">'validate_email'</span></li>
<li><span style="color: #335533">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF">),</span></li>
<li><span style="color: #0000FF">);</span></li>
<li><span style="color: #000000">?&gt;</span></li>

</ol><p>In the lines above, we prepare a definition array that defines our form. A definition array consists of an associative array where the key is the input field name and the value is an object of the <a href='/zetacomponents/documentation/trunk/UserInput/phpdoc/ezcInputFormDefinitionElement.html'>ezcInputFormDefinitionElement</a> class.</p><p>The first parameter to the constructor is either <a href='/zetacomponents/documentation/trunk/UserInput/phpdoc/ezcInputFormDefinitionElement.html#constREQUIRED'>ezcInputFormDefinitionElement::REQUIRED</a> for fields that <em>must</em> be submitted (although they can be empty) or <a href='/zetacomponents/documentation/trunk/UserInput/phpdoc/ezcInputFormDefinitionElement.html#constOPTIONAL'>ezcInputFormDefinitionElement::OPTIONAL</a> for optional fields. The second parameter is the filter to use for the input field. The filters are defined in PHP's <a href="http://pecl.php.net/filter">filter</a> extension, and can also be retrieved by the PHP function filter_list(). The third optional parameter contains flags to the filter. Those are documented in the <a href="http://php.net/filter">filter documentation</a>.</p><p>In the definition above, we define four input fields that are all required. Two of them are strings (firstName and lastName), one is an integer (age) and the last one is an e-mail address (email).</p><ol class="code">
<li><span style="color: #000000">&lt;?php</span></li>
<li><span style="color: #0000FF">foreach&nbsp;(&nbsp;</span><span style="color: #000000">$definition&nbsp;</span><span style="color: #0000FF">as&nbsp;</span><span style="color: #000000">$name&nbsp;</span><span style="color: #0000FF">=&gt;&nbsp;</span><span style="color: #000000">$dummy&nbsp;</span><span style="color: #0000FF">)</span></li>
<li><span style="color: #0000FF">{</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">$propertyName&nbsp;</span><span style="color: #0000FF">=&nbsp;</span><span style="color: #335533">"property_</span><span style="color: #000000">$name</span><span style="color: #335533">"</span><span style="color: #0000FF">;</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">$propertyWarningName&nbsp;</span><span style="color: #0000FF">=&nbsp;</span><span style="color: #335533">"warning_</span><span style="color: #000000">$name</span><span style="color: #335533">"</span><span style="color: #0000FF">;</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;$</span><span style="color: #000000">$propertyName&nbsp;</span><span style="color: #0000FF">=&nbsp;</span><span style="color: #335533">''</span><span style="color: #0000FF">;</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;$</span><span style="color: #000000">$propertyWarningName&nbsp;</span><span style="color: #0000FF">=&nbsp;</span><span style="color: #335533">''</span><span style="color: #0000FF">;</span></li>
<li><span style="color: #0000FF">}</span></li>
<li><span style="color: #000000">?&gt;</span></li>

</ol><p>Here, we initialize the variables that are used to show the current value and whether invalid data was submitted to the form. This is used later to render the form.</p><ol class="code">
<li><span style="color: #000000">&lt;?php</span></li>
<li><span style="color: #0000FF">if&nbsp;(&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/UserInput/phpdoc/ezcInputForm.html#hasGetData'>ezcInputForm::hasGetData</a></span><span style="color: #0000FF">()&nbsp;)</span></li>
<li><span style="color: #0000FF">{</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">$form&nbsp;</span><span style="color: #0000FF">=&nbsp;new&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/UserInput/phpdoc/ezcInputForm.html'>ezcInputForm</a></span><span style="color: #0000FF">(&nbsp;</span><span style="color: #000000">INPUT_GET</span><span style="color: #0000FF">,&nbsp;</span><span style="color: #000000">$definition&nbsp;</span><span style="color: #0000FF">);</span></li>
<li></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;(&nbsp;</span><span style="color: #000000">$definition&nbsp;</span><span style="color: #0000FF">as&nbsp;</span><span style="color: #000000">$name&nbsp;</span><span style="color: #0000FF">=&gt;&nbsp;</span><span style="color: #000000">$dummy&nbsp;</span><span style="color: #0000FF">)</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;{</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">$propertyName&nbsp;</span><span style="color: #0000FF">=&nbsp;</span><span style="color: #335533">"property_</span><span style="color: #000000">$name</span><span style="color: #335533">"</span><span style="color: #0000FF">;</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">$propertyWarningName&nbsp;</span><span style="color: #0000FF">=&nbsp;</span><span style="color: #335533">"warning_</span><span style="color: #000000">$name</span><span style="color: #335533">"</span><span style="color: #0000FF">;</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;</span><span style="color: #000000">$form</span><span style="color: #0000FF">-&gt;</span><span style="color: #000000">hasValidData</span><span style="color: #0000FF">(&nbsp;</span><span style="color: #000000">$name&nbsp;</span><span style="color: #0000FF">)&nbsp;)</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$</span><span style="color: #000000">$propertyName&nbsp;</span><span style="color: #0000FF">=&nbsp;</span><span style="color: #000000">$form</span><span style="color: #0000FF">-&gt;</span><span style="color: #000000">$name</span><span style="color: #0000FF">;</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$</span><span style="color: #000000">$propertyName&nbsp;</span><span style="color: #0000FF">=</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">htmlspecialchars</span><span style="color: #0000FF">(&nbsp;</span><span style="color: #000000">$form</span><span style="color: #0000FF">-&gt;</span><span style="color: #000000">getUnsafeRawData</span><span style="color: #0000FF">(&nbsp;</span><span style="color: #000000">$name&nbsp;</span><span style="color: #0000FF">)&nbsp;);</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$</span><span style="color: #000000">$propertyWarningName&nbsp;</span><span style="color: #0000FF">=&nbsp;</span><span style="color: #335533">'[invalid]'</span><span style="color: #0000FF">;</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;}</span></li>
<li><span style="color: #0000FF">}</span></li>
<li><span style="color: #000000">?&gt;</span></li>

</ol><p>In line 2, we check whether there was GET data submitted to this script. Aside from the <a href='/zetacomponents/documentation/trunk/UserInput/phpdoc/ezcInputForm.html#hasGetData'>ezcInputForm::hasGetData</a>() method to verify if there is GET data available, there is another method, <a href='/zetacomponents/documentation/trunk/UserInput/phpdoc/ezcInputForm.html#hasPostData'>ezcInputForm::hasPostData</a>(), which does the same thing but for POST data. Upon instantiation of the <a href='/zetacomponents/documentation/trunk/UserInput/phpdoc/ezcInputForm.html'>ezcInputForm</a> object in line 4, the component will parse the input data and make the input fields available through the object. In case one of the required input variables does not exist in the input data, this instantiation will throw an <a href='/zetacomponents/documentation/trunk/UserInput/phpdoc/ezcInputFormFieldNotFoundException.html'>ezcInputFormFieldNotFoundException</a> exception.</p><p>In lines 6 to 20, we loop over all elements from the definition and check (in line 10) whether the field has valid data. When there is valid data available, we retrieve the value from the $form object through a property (in line 12). In case the data for a field is invalid, we fetch the raw data with the <a href='/zetacomponents/documentation/trunk/UserInput/phpdoc/ezcInputForm.html#getUnsafeRawData'>ezcInputForm::getUnsafeRawData</a>() function, encode that with <a href="http://php.net/htmlspecialchars">htmlspecialchars</a> and set the parameter with the name "property_&lt;fieldname&gt;" to the encoded raw data. We also record in the "warning_&lt;fieldname&gt;" variable if the field has invalid data.</p><ol class="code">
<li>&lt;form&nbsp;action='tutorial_example_01.php'&gt;</li>
<li>First&nbsp;name:&nbsp;&lt;input&nbsp;type='text'&nbsp;name='firstName'&nbsp;value='<span style="color: #000000">&lt;?php&nbsp;</span><span style="color: #0000FF">echo&nbsp;</span><span style="color: #000000">$property_firstName</span><span style="color: #0000FF">;&nbsp;</span><span style="color: #000000">?&gt;</span>'/&gt;<span style="color: #000000">&lt;?php&nbsp;</span><span style="color: #0000FF">echo&nbsp;</span><span style="color: #000000">$warning_firstName</span><span style="color: #0000FF">;&nbsp;</span><span style="color: #000000">?&gt;</span>&lt;br/&gt;</li>
<li>Last&nbsp;name:&nbsp;&lt;input&nbsp;type='text'&nbsp;name='lastName'&nbsp;value='<span style="color: #000000">&lt;?php&nbsp;</span><span style="color: #0000FF">echo&nbsp;</span><span style="color: #000000">$property_lastName</span><span style="color: #0000FF">;&nbsp;</span><span style="color: #000000">?&gt;</span>'/&gt;<span style="color: #000000">&lt;?php&nbsp;</span><span style="color: #0000FF">echo&nbsp;</span><span style="color: #000000">$warning_lastName</span><span style="color: #0000FF">;&nbsp;</span><span style="color: #000000">?&gt;</span>&lt;br/&gt;</li>
<li>Age:&nbsp;&lt;input&nbsp;type='text'&nbsp;name='age'&nbsp;value='<span style="color: #000000">&lt;?php&nbsp;</span><span style="color: #0000FF">echo&nbsp;</span><span style="color: #000000">$property_age</span><span style="color: #0000FF">;&nbsp;</span><span style="color: #000000">?&gt;</span>'/&gt;<span style="color: #000000">&lt;?php&nbsp;</span><span style="color: #0000FF">echo&nbsp;</span><span style="color: #000000">$warning_age</span><span style="color: #0000FF">;&nbsp;</span><span style="color: #000000">?&gt;</span>&lt;br/&gt;</li>
<li>E-mail:&nbsp;&lt;input&nbsp;type='text'&nbsp;name='email'&nbsp;value='<span style="color: #000000">&lt;?php&nbsp;</span><span style="color: #0000FF">echo&nbsp;</span><span style="color: #000000">$property_email</span><span style="color: #0000FF">;&nbsp;</span><span style="color: #000000">?&gt;</span>'/&gt;<span style="color: #000000">&lt;?php&nbsp;</span><span style="color: #0000FF">echo&nbsp;</span><span style="color: #000000">$warning_email</span><span style="color: #0000FF">;&nbsp;</span><span style="color: #000000">?&gt;</span>&lt;br/&gt;</li>
<li>&lt;input&nbsp;type='submit'&nbsp;value='submit'/&gt;&lt;br/&gt;</li>
<li>&lt;/form&gt;</li>
<li><span style="color: #000000">&lt;?php</span></li>
<li><span style="color: #007700">//&nbsp;just&nbsp;to&nbsp;make&nbsp;my&nbsp;test&nbsp;script&nbsp;happy</span></li>
<li><span style="color: #000000">?&gt;</span></li>

</ol><p>The last part of this example renders the form. If previous data was submitted, it will be shown as the default value in the input fields. If the data for one of the fields is invalid, this will be shown next to the field.</p><a name="more-information"></a><a name="id4"></a><h3>More information</h3><p>The filters and their parameters are documented in the <a href="http://php.net/filter">filter documentation</a>.</p><!--Local Variables:
mode: rst
fill-column: 79
End:
vim: et syn=rst tw=79-->

	</div>

	<div class="footer">
	Copyright Â© 2010 <a href="http://apache.org">The Apache Software Foundation</a>
</div>
</div>
</body>
</html>
